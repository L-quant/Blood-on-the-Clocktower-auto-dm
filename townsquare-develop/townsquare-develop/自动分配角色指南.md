# 自动分配角色 - 操作指南

## 为什么要用自动分配？

手动分配角色需要：
1. 了解每个版本的角色组合规则
2. 根据玩家数量计算正确的角色数量
3. 手动选择每个角色
4. 确保角色组合合法

**自动分配功能**会帮你完成所有这些工作！

---

## 操作步骤

### 第一步：准备玩家
1. 点击右上角 **齿轮图标** ⚙️
2. 点击 **👥 玩家** 标签
3. 点击 **"添加 [A]"** 按钮
4. 输入玩家名称（例如："张三"）
5. 重复添加，直到有 **5-15 名玩家**

> 💡 提示：血染钟楼需要至少 5 名玩家才能开始游戏

---

### 第二步：选择游戏版本
1. 点击右上角 **齿轮图标** ⚙️
2. 点击 **🎭 角色** 标签
3. 点击 **"选择版本 [E]"**
4. 选择一个版本：
   - **Trouble Brewing** (暗流涌动) - 推荐新手
   - **Bad Moon Rising** (月圆之夜) - 中等难度
   - **Sects & Violets** (异教徒与紫罗兰) - 高级玩家

---

### 第三步：自动分配角色 ⭐
1. 点击右上角 **齿轮图标** ⚙️
2. 点击 **🤖 自动化说书人** 标签
3. 点击 **"打开控制面板"**
4. 在面板顶部找到 **"快速操作"** 区域
5. 点击 **"🎭 自动分配角色"** 按钮

**就这么简单！**

---

## 分配结果

点击按钮后，系统会：

1. ✅ 根据玩家数量自动计算角色组合
2. ✅ 从当前版本中随机选择角色
3. ✅ 确保角色组合符合游戏规则
4. ✅ 随机分配给每个玩家

你会看到一个弹窗显示分配摘要：

```
角色分配成功！

村民: 5
外来者: 0
爪牙: 1
恶魔: 1

善良阵营: 5
邪恶阵营: 2
```

---

## 查看玩家角色

分配完成后：
1. 点击圆桌上的任意玩家
2. 查看他们的角色卡片
3. 可以看到角色名称、能力描述等信息

---

## 常见问题

### Q: 按钮是灰色的，无法点击？
**A:** 确保满足以下条件：
- ✅ 至少添加了 5 名玩家
- ✅ 已经选择了游戏版本

### Q: 分配的角色不满意，可以重新分配吗？
**A:** 可以！再次点击"自动分配角色"按钮即可重新分配。

### Q: 我想手动选择特定角色怎么办？
**A:** 使用传统方式：
1. 齿轮 → 🎭 角色
2. 点击"选择并分配 [C]"
3. 手动选择你想要的角色

### Q: 自动分配会考虑特殊角色吗？
**A:** 会的！系统会正确处理：
- 酒鬼（认为自己是村民）
- 疯子（认为自己是恶魔）
- 其他特殊规则角色

---

## 角色组合规则参考

不同玩家数量的标准角色组合：

| 玩家数 | 村民 | 外来者 | 爪牙 | 恶魔 |
|--------|------|--------|------|------|
| 5      | 3    | 0      | 1    | 1    |
| 6      | 3    | 1      | 1    | 1    |
| 7      | 5    | 0      | 1    | 1    |
| 8      | 5    | 1      | 1    | 1    |
| 9      | 5    | 2      | 1    | 1    |
| 10     | 7    | 0      | 2    | 1    |
| 11     | 7    | 1      | 2    | 1    |
| 12     | 7    | 2      | 2    | 1    |
| 13     | 9    | 0      | 3    | 1    |
| 14     | 9    | 1      | 3    | 1    |
| 15     | 9    | 2      | 3    | 1    |

> 自动分配功能会严格遵守这些规则！

---

## 下一步

角色分配完成后，你可以：

1. **启动自动化系统**
   - 在自动化面板点击"初始化自动化系统"
   - 然后点击"启动"
   - 系统会自动处理夜间行动和投票

2. **手动游戏**
   - 齿轮 → 📖 魔典 → 切换到夜晚
   - 手动执行每个角色的能力
   - 切换到白天进行讨论和投票

---

## 技术细节（给开发者）

自动分配功能使用了以下模块：
- `RoleAssigner.js` - 角色分配逻辑
- `ScriptDefinitions.js` - 脚本和角色定义
- `RoleCompositionValidator.js` - 角色组合验证

分配算法：
1. 根据玩家数量查表获取角色组合
2. 从脚本中随机选择对应数量的各类角色
3. 使用 Fisher-Yates 算法打乱角色顺序
4. 按顺序分配给玩家
5. 处理特殊角色规则（酒鬼、疯子等）

---

**祝游戏愉快！** 🎉
